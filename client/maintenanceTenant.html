<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
        integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="/css/fonts.css">
    <link rel="stylesheet" href="/css/maintenanceTenant.css">
    <link rel="stylesheet" href="/css/navigation.css">
    <title>Maintenance - Tenant</title>
</head>

<body>
    <div class="overlay" id="overlay"></div>
    <div id="sidebarContainer"></div>
    <div id="navbarContainer"></div>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Overview Section -->
        <div class="overview-section">
            <h2 class="overview-title">
                Request Overview
            </h2>
            <div class="overview-grid" id="overviewGrid">
                    <!-- Overview cards will be populated here -->
                    <div class="overview-card">
                        <div class="overview-header">
                            <span class="overview-icon"><i class="fa-solid fa-ticket"></i></span>
                        </div>
                        <div class="overview-number">0</div>
                        <div class="overview-label">Total Requests</div>
                        <div class="overview-description">All maintenance requests submitted</div>
                    </div>
                    <div class="overview-card">
                        <div class="overview-header">
                            <span class="overview-icon"><i class="fa-solid fa-spinner"></i></span>
                        </div>
                        <div class="overview-number">0</div>
                        <div class="overview-label">Active</div>
                        <div class="overview-description">Requests currently in progress</div>
                    </div>
                    <div class="overview-card">
                        <div class="overview-header">
                            <span class="overview-icon"><i class="fa-solid fa-circle-check"></i></span>
                        </div>
                        <div class="overview-number">0</div>
                        <div class="overview-label">Completed</div>
                        <div class="overview-description">Requests marked as completed</div>
                    </div>
                    <div class="overview-card">
                        <div class="overview-header">
                            <span class="overview-icon"><i class="fa-solid fa-circle-xmark"></i></span>
                        </div>
                        <div class="overview-number">0</div>
                        <div class="overview-label">Cancelled</div>
                        <div class="overview-description">Requests that were cancelled</div>
                    </div>
            </div>
        </div>

        <!-- Main Content Grid -->
        <div class="content-grid">
            <!-- Submit New Request Card -->
            <div class="function-card">
                <div class="card-header">
                    <h2 class="card-title">
                        <span class="card-title-icon"><i class="fa-solid fa-paper-plane"></i></span>
                        Submit New Request
                    </h2>
                    <p class="card-description">Report maintenance issues and track their progress through our
                        professional system</p>
                </div>
                <div class="card-body">
                    <div id="successMessage" class="success-message" style="display: none;">
                        <strong>Request submitted successfully!</strong><br>
                        Your request ID is: <strong id="requestId"></strong>
                    </div>

                    <form id="maintenanceForm">
                        <div class="form-section">
                            <h3 class="section-title">Select Lease</h3>
                            <div class="form-group">
                                <label class="form-label required" for="leaseSelect">Lease</label>
                                <select id="leaseSelect" class="form-select" required>
                                    <option value="">Select an existing lease</option>
                                    <!-- Lease options should be populated dynamically -->
                                </select>
                                <div class="error-message" id="leaseSelectError"></div>
                            </div>
                        </div>
                        <div class="form-section">
                            <h3 class="section-title">Contact Information</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label required" for="tenantName">Tenant Name</label>
                                    <input type="text" id="tenantName" class="form-input" required>
                                    <div class="error-message" id="tenantNameError"></div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label required" for="unitNumber">Unit Number</label>
                                    <input type="text" id="unitNumber" class="form-input" placeholder="e.g., 2A"
                                        required>
                                    <div class="error-message" id="unitNumberError"></div>
                                </div>
                            </div>
                            <div class="form-group" style="display: flex; align-items: center; gap: 1rem;">
                                <label class="form-label required" for="contactPhone">Contact Phone</label>
                                <input type="tel" id="contactPhone" class="form-input" placeholder="(555) 123-4567"
                                    required>
                                <label style="display: flex; align-items: center; gap: 0.25rem; margin-left: 1rem;">
                                    <input type="checkbox" id="useExistingPhone" style="margin-right: 0.25rem;">
                                    <span style="font-size: 0.95em;">Use my existing phone number</span>
                                </label>
                                <div class="error-message" id="contactPhoneError"></div>
                            </div>
                        </div>

                        <div class="form-section">
                            <h3 class="section-title">Request Details</h3>
                            <div class="form-group">
                                <label class="form-label required" for="ticketTitle">Request Title</label>
                                <input type="text" id="ticketTitle" class="form-input" placeholder="Short summary of the issue" maxlength="100" required>
                                <div class="error-message" id="ticketTitleError"></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label required" for="category">Service Category</label>
                                <select id="category" class="form-select" required>
                                </select>
                                <div class="error-message" id="categoryError"></div>
                            </div>

                            <div class="form-group">
                                <label class="form-label required" for="description">Detailed Description</label>
                                <textarea id="description" class="form-textarea"
                                    placeholder="Please provide a detailed description of the maintenance issue, including location, symptoms, and any relevant details..."
                                    required></textarea>
                                <div class="error-message" id="descriptionError"></div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Upload Supporting Photos/Videos</label>
                                <div class="file-upload-wrapper">
                                    <input type="file" id="photos" class="file-upload-input" accept="image/*,video/*" multiple style="display:none;">
                                    <label for="photos" class="file-upload-label">
                                        <span><i class="fa-solid fa-paperclip"></i></span>
                                        <span>Click to upload photos/videos (optional, up to 5 files, max 10MB each)</span>
                                    </label>
                                    <div class="file-upload-preview">
                                        <div class="file-preview-list" id="filePreviewList"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="submit-button">Submit Request</button>
                    </form>
                </div>
            </div>

            <!-- Active Requests Card -->
            <div class="function-card">
                <div class="card-header">
                    <h2 class="card-title">
                        <span class="card-title-icon"><i class="fa-solid fa-list-check"></i></span>
                        Active Requests
                    </h2>
                    <p class="card-description">Monitor the status and progress of your current maintenance requests</p>
                </div>
                <div class="card-body">
                    <div id="requestsList">
                        <!-- Active requests will be populated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- History Section -->
        <div class="function-card history-section">
            <div class="card-header">
                <h2 class="card-title">
                    <span class="card-title-icon"><i class="fa-solid fa-clock-rotate-left"></i></span>
                    Maintenance History
                </h2>
                <p class="card-description">Complete record of past maintenance requests, resolutions, and service
                    ratings</p>
            </div>
            <div class="card-body">
                <div class="history-filters">
                    <input type="text" id="historySearch" class="form-input"
                        placeholder="Search by request ID, description, or category...">
                    <select id="statusFilter" class="form-select">
                        <option value="">All Status</option>
                        <option value="completed">Completed</option>
                        <option value="cancelled">Cancelled</option>
                    </select>
                    <select id="categoryFilter" class="form-select">
                        <option value="">All Categories</option>
                        <option value="plumbing">Plumbing</option>
                        <option value="electrical">Electrical</option>
                        <option value="hvac">HVAC</option>
                        <option value="appliance">Appliance</option>
                        <option value="structural">Structural</option>
                        <option value="security">Security</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <div class="date-range">
                    <div class="date-range-label">Filter by completion date range:</div>
                    <input type="date" id="dateFrom" class="form-input" title="From Date">
                    <input type="date" id="dateTo" class="form-input" title="To Date">
                </div>

                <div id="historyList">
                    <!-- History items will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Confirmation Dialog Modal -->
    <div class="modal-overlay" id="confirmationModal" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3>Confirm Ticket Submission</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to submit this maintenance request?</p>
                <div class="modal-notice">
                    <i class="fa-solid fa-info-circle"></i>
                    <span>This ticket will be reviewed by an administrator before being assigned to a technician.</span>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="modal-btn cancel-btn" id="cancelSubmit">Cancel</button>
                <button type="button" class="modal-btn confirm-btn" id="confirmSubmit">
                    <span class="btn-text">Submit Request</span>
                    <span class="btn-loading" style="display: none;">
                        <i class="fa-solid fa-spinner fa-spin"></i> Submitting...
                    </span>
                </button>
            </div>
        </div>
    </div>

    <script type="module" src="/constants/constants.js"></script>
    <script type="module" src="/javascript/maintenanceTenant.js"></script>
    <script src="/javascript/navigations.js"></script>
</body>

</html>